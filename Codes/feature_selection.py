from sklearn.ensemble import ExtraTreesClassifier
from sklearn.feature_selection import SelectFromModel
import numpy as np

def select_features_tree(X, y, feature_names = []):
	print(X.shape)
	forest = ExtraTreesClassifier(n_estimators=1000, n_jobs=8)
	fo = forest.fit(X, y)
	sorted_feature_names = get_feature_names(fo, X, feature_names)
	model = SelectFromModel(fo, prefit=True,)
	X_new = model.transform(X)
	print(X_new.shape)
	return X_new, sorted_feature_names[0:X_new.shape[1]]

def get_feature_names(model_name, train, feature_names):
	args = np.argsort(-model_name.feature_importances_)

	sorted_feature_names = []
	for i in range(len(args)):
		sorted_feature_names.append(feature_names[args[i]])

	return sorted_feature_names